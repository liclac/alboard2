{% extends 'base.html' %}
{% load markdown_deux_tags i18n %}
{% block title %}{% trans "Picture" %} | {{ pool.name }}{% endblock %}
{% block body_class %}has-bottom-bar{% endblock %}
{% block content %}
	<div class="col-xs-12">
		<a class="thumbnail">
			<img src="{{ post.image.url }}" />
			<div class="caption clearfix">
				<div class="description">
					{{ post.description|markdown|default:"<p></p>" }}
				</div>
				<div class="meta">
					<span class="pull-left">
						<i class="glyphicon glyphicon-tags"></i>&nbsp;
						{% for tag in post.tags.names %}
							{% if not forloop.first %}, {% endif %}{{ tag }}{% empty %}<span class="text-muted">No Tags</span>
						{% endfor %}
					</span>
					<span class="pull-right"><i class="glyphicon glyphicon-user"></i> {{ post.signature|default:_("Anonymous") }}</span>
				</div>
			</div>
		</a>
	</div>
	<nav class="navbar navbar-fixed-bottom navbar-default navbar-justified">
		<ul class="nav navbar-nav">
			<li class="prev-button {% if not prev_post %}disabled{% endif %}">
				<a {% if prev_post %}href="{% url 'post' prev_post.pool.id prev_post.id %}"{% endif %} id="go-prev"><span aria-hidden="true">&larr;</span>&nbsp;{% trans "Previous" %}</a>
			</li>
			
			<li><a href="{% url 'pool' pool.id %}">{{ pool.name }}</a></li>
			
			{% with next_post as p %}
				<li class="next-button {% if not p %}disabled{% endif %}">
					<a {% if next_post %}href="{% url 'post' next_post.pool.id next_post.id %}"{% endif %} id="go-next">{% trans "Next" %}&nbsp;<span aria-hidden="true">&rarr;</span></a>
				</li>
			{% endwith %}
		</ul>
	</nav>
{% endblock %}
{% block after_body %}
	<script>
		$(document).keydown(function(e) {
			// Ignore presses with modifiers; we don't want to interfere with
			// tab cycling or the like - only lone arrow key presses
			if(e.altKey || e.ctrlKey || e.metaKey || e.shiftKey)
				return;
			else if(e.which == 37 || e.which == 65 || e.which == 72) // Left, A, H
				$('#go-prev')[0].click();
			else if(e.which == 39 || e.which == 68 || e.which == 76) // Right, D, L
				$('#go-next')[0].click();
			else if(e.which == 87 || e.which == 75) // W, K
				window.scrollBy(0, -50);
			else if(e.which == 83 || e.which == 74) // S, J
				window.scrollBy(0, 50);
			else
				return;
			e.preventDefault();
		});
	</script>
{% endblock %}
